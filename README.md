# tech-notes
快速技术笔记，短小精悍

## 为什么 UTF-8 不存在字节序问题？
UTF-8 是可变长度的编码格式，采用 1~4 字节表示一个 Unicode 字符。理论上在大于 1 个字节的表示时应该需要确定字节序，但是由于 UTF-8 有其固定的编码规则，这个规则恰好确定了多字节表示时的字节顺序，也就没有字节序的问题了。UTF-8 的编码规则如下：

- 1 字节表示时，格式为 `0xxxxxxx`
- 2 字节表示时，格式为 `110xxxxx 10xxxxxx`
- 3 字节表示时，格式为 `1110xxxx 10xxxxxx 10xxxxxx`
- 4 字节表示时，格式为 `11110xxx 10xxxxxx 10xxxxxx 10xxxxxx`

可以看到，UTF-8 编码在不同字节数表示下，其中都有独特确定的比特位，如 `110`、`1110`、`11110`，而这刚好确定了多字节下的字节顺序。比如当遇到 `11100100 10111010 10111010` 这么一个 3 字节的 UTF-8 编码数据，那么根据规则，`1110` 开头的就是须先读的字节头，于是就确定了顺序得是从高读到低。或者也可以理解成 UTF-8 在多字节时其实固定了是 BE（Big-Endian）表示。

所以如果 `11100100 10111010 10111010` 先读低位的 `10111010` 那么它就不是一个有效的 UTF-8 数据了，因为不符合其编码规则。

- `11100100 10111010 10111010` 转换成十六进制即 `E4BABA`，对应 UTF-8 中表示汉字「人」。
- `10111010 10111010 11100100` 转换成十六进制即 `BABAE4`，不是有效的 UTF-8 编码。
